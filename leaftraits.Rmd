---
title: "leaftraits"
author: "Stephanie Ma Lucero"
date: "2023-05-24"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r load libraries, include=FALSE}

library(here) # similar to set working directory
library(dplyr) # includes functions:
library(tidyverse) # data wrangling, includes packages: ggplot2, tibble, tidyr, rear, purrr, stringr, forcats

```

```{r load data, include=FALSE}

leaftraits_load <- read_csv("data/leaftraits_2023.csv", 
                            col_types = cols(
                              species = col_character(), 
                              individual_ID = col_character(),
                                leaf_number = col_character(),
                                area_m2 = col_number(),
                                SLA_m2kg = col_number(),
                                leaf_LDMC_proportion = col_number(),
                                leaf_LDMC_percent = col_number(),
                                leaf_thickness_check_cm = col_number()
                            ))

leaftraits <- leaftraits_load %>% 
  dplyr::select(species, individual_ID, leaf_number, area_m2, SLA_m2kg, leaf_LDMC_proportion, leaf_LDMC_percent, leaf_thickness_check_cm) %>% 
  rename(leaf_thickness_cm = leaf_thickness_check_cm)

glimpse(leaftraits)
```
# LEAF TRAITS
### 1) SLA
```{r sla, include=TRUE}

ggplot(data = leaftraits, aes(y = SLA_m2kg, x = species, color = individual_ID)) + 
  geom_jitter()

print(TukeyHSD(aov(SLA_m2kg ~ individual_ID, data = leaftraits %>%  filter(species =="HEAR")))) # leaf sla is similar between individuals
print(TukeyHSD(aov(SLA_m2kg ~ individual_ID, data = leaftraits %>%  filter(species =="SAAP")))) # leaf sla is similar between individuals
print(TukeyHSD(aov(SLA_m2kg ~ individual_ID, data = leaftraits %>%  filter(species =="CEOL")))) # leaf sla is similar between individuals
print(TukeyHSD(aov(SLA_m2kg ~ individual_ID, data = leaftraits %>%  filter(species =="RHOV")))) # leaf sla is NOT similar between RHOV individuals
#$individual_ID
#                     diff         lwr         upr     p adj
#rhov-2-rhov-12 -1.7328279 -3.95462970  0.48897384 0.1488349
#rhov-6-rhov-12 -2.2332392 -4.45504100 -0.01143746 0.0486974 <-- 6 and 12
#rhov-9-rhov-12  0.5112162 -1.71058554  2.73301800 0.9015383
#rhov-6-rhov-2  -0.5004113 -2.72221307  1.72139047 0.9068663
#rhov-9-rhov-2   2.2440442  0.02224239  4.46584593 0.0474970 <-- 2 and 9
#rhov-9-rhov-6   2.7444555  0.52265369  4.96625723 0.0147640 <-- 6 and 9

# highlight all and run as one command
SLA <- aov(SLA_m2kg ~ species, data = leaftraits)
print(summary(SLA))
print(TukeyHSD(SLA))
leaftraits %>%  
  group_by(species) %>% 
  summarize(avg_SLA_m2kg = mean(SLA_m2kg), 
            SD = sd(SLA_m2kg),
            N = length(SLA_m2kg), 
            SE = ((sd(SLA_m2kg))/sqrt(length((SLA_m2kg)))))
```
### 2) LDMC 
```{r ldmc, include=TRUE}

ggplot(data = leaftraits, aes(y = leaf_LDMC_proportion, x = species, color = individual_ID)) + 
  geom_jitter()

print(TukeyHSD(aov(leaf_LDMC_proportion ~ individual_ID, data = leaftraits %>%  filter(species =="HEAR")))) # ldmc is not similar
#$individual_ID
#              diff          lwr          upr     p adj
#H2-H1  0.054775069  0.028450382  0.081099756 0.0002401 <-- 1 and 2
#H4-H1  0.030006824  0.003682137  0.056331510 0.0242512 <-- 1 and 4
#H3-H2 -0.058831491 -0.085156178 -0.032506805 0.0001230 <-- 3 and 2
#H4-H3  0.034063246  0.007738560  0.060387933 0.0108842 <-- 3 and 4
print(TukeyHSD(aov(leaf_LDMC_proportion ~ individual_ID, data = leaftraits %>%  filter(species =="SAAP")))) # leaf ldmc is not similar
#$individual_ID
#              diff         lwr          upr     p adj
#S5-S2 -0.081518376 -0.15076894 -0.012267814 0.0199746 <-- 5 and 2
#S5-S4 -0.074509568 -0.14376013 -0.005259006 0.0338004 <-- 5 and 4
print(TukeyHSD(aov(leaf_LDMC_proportion ~ individual_ID, data = leaftraits %>%  filter(species =="CEOL")))) # leaf ldmc is similar between individuals
print(TukeyHSD(aov(leaf_LDMC_proportion ~ individual_ID, data = leaftraits %>%  filter(species =="RHOV")))) # RHOV 9 and 2 are not the same

# highlight all and run as one command
LDMC <- aov(leaf_LDMC_proportion ~ species, data = leaftraits)
print(summary(LDMC))
print(TukeyHSD(LDMC))
leaftraits %>%  
  group_by(species) %>% 
  summarize(avg_LDMC_proportion = mean(leaf_LDMC_proportion), 
            SD = sd(leaf_LDMC_proportion),
            N = length(leaf_LDMC_proportion), 
            SE = ((sd(leaf_LDMC_proportion))/sqrt(length((leaf_LDMC_proportion)))))
```
### 3) leaf thickness  
```{r leaf thickness, include=TRUE}

ggplot(data = leaftraits, aes(y = leaf_thickness_cm, x = species, color = individual_ID)) + 
  geom_jitter()

print(TukeyHSD(aov(leaf_thickness_cm ~ individual_ID, data = leaftraits %>%  filter(species =="HEAR")))) # leaf thickness is similar among leaves
print(TukeyHSD(aov(leaf_thickness_cm ~ individual_ID, data = leaftraits %>%  filter(species =="SAAP")))) # leaf thickness is not similar among the four leaves
#$individual_ID
#          diff           lwr         upr     p adj
#S4-S2  0.00900  0.0021035594 0.015896441 0.0102785 <-- 4 and 2
#S5-S2  0.00775  0.0008535594 0.014646441 0.0263699 <-- 2 and 5 
#S4-S3  0.00725  0.0003535594 0.014146441 0.0384030 <-- 4 and 3
print(TukeyHSD(aov(leaf_thickness_cm ~ individual_ID, data = leaftraits %>%  filter(species =="CEOL")))) # leaf thickness is similar among leaves
print(TukeyHSD(aov(leaf_thickness_cm ~ individual_ID, data = leaftraits %>%  filter(species =="RHOV")))) # leaf thickness is not similar among the four leaves
#rhov-9-rhov-2  -0.01275 -0.022624665 -0.0028753349 0.0110423 <-- 9 and 2
#rhov-9-rhov-6  -0.01075 -0.020624665 -0.0008753349 0.0316464 <-- 9 and 6

# highlight all and run as one command
Lt <- aov(leaf_thickness_cm ~ species, data = leaftraits)
print(summary(Lt))
print(TukeyHSD(Lt))
leaftraits %>%  
  group_by(species) %>% 
  summarize(avg_Leafthickness_cm = mean(leaf_thickness_cm), 
            SD = sd(leaf_thickness_cm),
            N = length(leaf_thickness_cm), 
            SE = ((sd(leaf_thickness_cm))/sqrt(length((leaf_thickness_cm)))))
```

# LIGHT CURVES
```{r load light curve data, include=FALSE}

par <- read_csv("data/par_data.csv")

par %>%  
  group_by(weeding) %>% 
  summarize(below_min = min(below_PAR_1), 
            below_mean = mean(below_PAR_1), 
            below_median = median(below_PAR_1),
             below_max = max(below_PAR_1))#,
            amb_min = min(ambient_PAR_1), 
             amb_mean = mean(ambient_PAR_1),
              amb_max = max(ambient_PAR_1)
       )
# below_min    below_mean    below_max
# 25	          495.5538	    1384	

# amb_min      amb_mean      amb_max
# 361	          1267.144	    1764

# Light curve levels: 0, 25, 50, 100, 250, 500,  1000, 2000
par.scatter <- ggplot(data = par, 
                       aes(x = below_PAR_1, y = ambient_PAR_1)) +
  geom_point(aes(color = (weeding))) 
ggplotly(par.scatter)

# calculate mean photo based on 1000 PAR, which is closest to max PAR experienced by seedlings.

# calculate mean photo based on 500 PAR, which is the mean PAR experienced by seedlings.

# calculate mean photo based on 250 PAR, which is close to the min PAR experienced by seedlings.

```


# DROUGHT
```{r}

```

