---
title: "Piru_enchancement-Models"
author: "Kit Swift"
date: "2022-12-15"
output: html_documents
---

# Load libraries

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r libraries-data, message=FALSE}
library(here) # similar to set working directory
library(tidyverse) # data wrangling
library(lubridate) # dates and times
library(ggthemes)
library(plotly)
library(dplyr)
library(olsrr)
#library(survival)
library(lme4)
library(lmerTest)
library(multcomp)
library(multcompView)
library(emmeans)
library(multcomp) # functions: multcompLetters2, multcompLetters3, multcompLetters4 using aov object

#mafa_cover_all = MAFA % cover 2018 and 2019
#exotic_cover_all = exotic % cover 2018 and 2019

```

# Load colors for graphs

```{r colors, include=TRUE}
devtools::install_github("an-bui/calecopal")

library(calecopal)
# all palettes
names(cal_palettes)

# Site colors: 1, 2 
cal_palette(name = "chaparral1", n = 5, type = "continuous") # [1] "#DCC27A" "#F19B34"
site1color <- "#DCC27A"
site2color <- "#F19B34"
sitecolors <- c(site1color, site2color)

# Treatment colors: Full, half, none 
cal_palette(name = "chaparral3", n = 5, type = "continuous") # [1] "#D3E3CA", "#92A587", "#2F3525"
cal_palette(name = "desert", n = 5, type = "continuous") # [1] "#F6EECF", "#B09175", "#291611"
treatment1color <- "#F6EECF"
treatment2color <- "#B09175"
treatment3color <- "#291611"
treatmentcolors <- c(treatment1color, treatment2color, treatment3color)

```

# Question 1: How do environmental conditions change by a) canopy treatment and b) canopy cover?

Is canopy treatment or canopy cover a stronger predictor of the environmental conditions below the shrub canopy?

Notes: - **response variable**: The variable you want to test. (e.g.,. PAR, TDR, nncover) - **explanatory variables**: The variables that can explain the outcome. (e.g., treatment, mafacover, site) - **data frame**: Include all the data you'll be working with. (e.g., combine par and mafa_cover_all) - **formula**: a formula is a two-sided linear formula object describing both the *fixed-effects* and *random effects* part of the model, with the response on the left of a \~ operator and the terms, separated by + operators, on the right. - **random effects**: Random-effects terms are distinguished by vertical bars **(\|)** separating expressions for design matrices from grouping factors. Two vertical bars **(\|\|)** can be used to specify multiple uncorrelated random effects for the same grouping variable. + Because of the way it is implemented, the \|\|-syntax works only for design matrices containing numeric (continuous) predictors; to fit models with independent categorical effects, see dummy or the lmer_alt function from the afex package.)

### Load PAR, TDR, and non-native percent cover data.

### Saved as a csv in the "Processed" data folder.

```{r load data, include=TRUE}
# variables as characters
# data as double numbers
mafa_cover_all_load <- read_csv("data/processed/mafa_cover_all.csv",
  col_types = cols(
    plot_number = col_character(),
    year = col_character(),
    cover_percent = col_double(),
    site = col_character()
    )
  )
mafa_cover_all <- mafa_cover_all_load %>% 
  dplyr::select(plot_number, year, cover_percent, site)

par_load <- read_csv("data/processed/par.csv",
  col_types = cols(
    date = col_character(),
    plot_number = col_character(),
    treatment = col_character(),
    year = col_character(),
    month = col_character(),
    site = col_character(),
    normalized_par = col_double()
    )
  )

par <- par_load %>% 
  dplyr::select(date, year, month, site, plot_number, treatment, normalized_par)

tdr_load <- read_csv("data/processed/tdr.csv",
  col_types = cols(
    plot_number = col_character(),
    treatment = col_character(),
    year = col_character(),
    month = col_character(),
    site = col_character(),
    soil_moisture = col_double()
    )
  )
tdr <- tdr_load %>% 
  dplyr::select(date, year, month, site, plot_number, treatment, soil_moisture)

exotic_cover_all_load <- read_csv("data/processed/exotic_cover_all.csv",
    col_types = cols(
    year = col_character(),
    plot_number = col_character(),
    MAFA_removal = col_character(),
    site = col_character(),
    cover_percent = col_double()
    )
)
exotic_cover_all <- exotic_cover_all_load %>% 
  dplyr::select(date, year, site, plot_number, MAFA_removal, cover_percent)

survmort_load <- read_csv("data/processed/survmort.csv",
                          col_types = cols(
                             year = col_character(),
                             month = col_character(), 
                             plot_number = col_character(),
                             treatment = col_character(), 
                             species = col_character(), 
                             alive = col_integer(), 
                             dead = col_integer(), 
                             site = col_character(), 
                             month_count = col_integer(), 
                             transplanted = col_character()
                          )
                          )
survmort <- survmort_load %>% 
  dplyr::select(year, month, plot_number, treatment, species, alive, dead, site, month_count, transplanted)
print(survmort)
summary(survmort)

```

```{r left join to mafa_cover_all, include=TRUE}
# PAR
parmod <- par %>%
  left_join(mafa_cover_all, by = c("year", "site", "plot_number"), na.rm = F) %>% 
  rename(mafacover = cover_percent)
print(parmod)
parmod %>% 
  group_by(year, treatment) %>% 
  summarise(N = length(normalized_par))

# TDR
tdrmod <- tdr %>% 
  left_join(mafa_cover_all, by = c("year", "site", "plot_number"), na.rm = F) %>% 
  rename(mafacover = cover_percent) %>% 
  filter(year <= 2019)
print(tdrmod)
tdrmod %>% 
  group_by(year, treatment) %>% 
  summarise(N = length(soil_moisture))

# write.csv(tdrmod, "data/processed/tdr_model.csv")
# tdr1 <- filter(tdrmod, site == "1")
# tdr2 <- filter(tdrmod, site == "2")

# NN COVER
nnmod <- exotic_cover_all %>% 
   left_join(mafa_cover_all, by = c("year", "site", "plot_number"), na.rm = F) %>% 
  rename(nncover = cover_percent.x,
         mafacover = cover_percent.y, 
         treatment = MAFA_removal) #%>% 
  # dplyr::select("date", "year", "site", "plot_number", "treatment", "nncover", "mafacover")
print(nnmod)
nnmod %>%  # check number of data points
  group_by(year, treatment) %>% 
  summarise(N = length(mafacover))
# write.csv(nnmod, "data/processed/nn_model.csv")
# nnmod1 <- filter(nnmod, site == "1")
# nnmod2 <- filter(nnmod, site == "2")
```

------------------------------------------------------------------------

## PAR linear mixed-effects model

1.  lmer

2.  testing the residuals for normality

```{r par model - normality, include = TRUE}

lme.parmod <- lmer(normalized_par ~ treatment + mafacover + site + month + (1|date) + (1|plot_number) + (1|year),
                   data = parmod)

MOD <- lme.parmod

# Calculate model's residual and fitted values
F1 <- fitted(MOD)
E1 <- residuals(MOD, "pearson")

# See residuals as a histogram, look for normal distribution
hist(E1)

# Graph residuals against a normal distribution, look for all points to be on 1:1 line
#need to call next two lines together
qqnorm(E1, xlab = "Theoretical Quantiles", ylab = "Pearson Residuals")
qqline(E1)

# Graph residuals vs fitted values to inspect homogeneity of variance, look for a random scattering of plots
# run together 2 lines
plot(x=F1, y=E1, xlab="Fitted Model Values", ylab="Pearson Residuals", main = "Variance")
abline(h = 0) # looking for random scatter

# Check for crazy outliers, look for lines MUCH taller than the rest of data
plot(cooks.distance(MOD))

# Plot a box plot for each factor, look for equal variance amount levels along the zero line
# Box plots need to be assessed for every fixed effect (categorical factor) for your model. 
# Random effects need the qqline just like normality. 
# So, only site and treatment get box plots. 
# MAFA cover is a covariate (continuous variable).
boxplot(E1 ~ treatment, data = parmod)
abline(h = 0)

boxplot(E1 ~ month, data = parmod)
abline(h = 0)

boxplot(E1 ~ site, data = parmod)
abline(h = 0)

# Plot each random effect in the model - things in the (1|_), look for dots along 1:1 line
qqnorm(ranef(MOD)$date[,1], main = "Plot Residuals")
qqline(ranef(MOD)$date[,1]) # unique dates

qqnorm(ranef(MOD)$plot_number[,1], main = "Plot Residuals")
qqline(ranef(MOD)$plot_number[,1]) # unique plots

#qqnorm(ranef(MOD)$year[,1], main = "Plot Residuals") # year doesn't run becuase only 2 numbers
#qqline(ranef(MOD)$year[,1]) # unique plots
```

3.  statistics

```{r par model - stats, include = TRUE}
# print 
print(lme.parmod)
summary(lme.parmod) # p-values
anova(lme.parmod) # fixed level effects, pvalues, etc.
# par is significant by mafa cover and month

# anova(lme.parmod) # fixed level effects, pvalues, etc.
#Type III Analysis of Variance Table with Satterthwaite's method
#           Sum Sq  Mean Sq NumDF   DenDF F value    Pr(>F)    
#treatment 0.00067 0.000336     2  34.513  0.0197 0.9805359    
#mafacover 0.21026 0.210258     1 137.703 12.3214 0.0006057 ***
#site      0.01195 0.011947     1  40.192  0.7001 0.4076914    
#month     1.77375 0.295624     6 250.588 17.3240 < 2.2e-16 ***

# post-hoc Tukey test
# visualize significant factors from anova(lme.parrmod)

emmip(lme.parmod, mafacover ~ month)

# get stats on interactions
emmeans(lme.parmod, list(pairwise ~ mafacover*month), adjust = "tukey") # <--- What do these results mean?

# mean, SE: year x month
parmod %>% 
  group_by(year, month) %>% 
  summarise(MEAN_par=mean(normalized_par, na.rm = TRUE),
            SD = sd(normalized_par, na.rm = TRUE),
            N = length(normalized_par), 
            SE = ((sd(normalized_par, na.rm = TRUE))/sqrt(length((normalized_par))))
            )

# mean, SE: year x treatment
parmod %>% 
  group_by(year, treatment) %>% 
  summarise(MEAN_par=mean(normalized_par, na.rm = TRUE),
            SD = sd(normalized_par, na.rm = TRUE),
            N = length(normalized_par), 
            SE = ((sd(normalized_par, na.rm = TRUE))/sqrt(length((normalized_par))))
            )
```

4.  figures

```{r par model - figures, include=TRUE}
# scatterplot: PAR x date
ggplot(data = parmod, aes(x = date, y = normalized_par)) + 
  geom_point(aes(color = treatment)) +
labs(title = "Normalized PAR over time", x = "Date", y = "Nomalized PAR") +
  geom_smooth(method="lm")+
  theme_bw()

# scatterplot: PAR x mafacover (%)
ggplot(data = parmod, aes(x = mafacover, y = normalized_par)) + 
  geom_point(aes(color = month)) +
labs(title = "Normalized PAR by MAFA cover (%)", x = "MAFA canopy cover (%)", y = "PAR") +
  geom_smooth(method="lm")+
  theme_bw()

# scatterplot: PAR x mafacover x treatment <-- use treatmentcolor instead of default
ggplot(data = parmod, aes(x = mafacover, y = normalized_par)) + 
  geom_point(aes(color = treatment)) +
  labs(title = "Normalized PAR by MAFA cover (%) and Treatment", x = "MAFA canopy cover (%)", y = "PAR") +
  theme_bw()

# scatterplot: PAR x mafacover x site <-- make site not continuous & use sitecolor instead of default
ggplot(data = parmod, aes(x = mafacover, y = normalized_par)) + 
  geom_point(aes(color = site)) +
  labs(title = "Normalized PAR by MAFA cover (%) and Site", x = "MAFA canopy cover (%)", y = "PAR") +
  theme_bw() 

#ggplot(crab_data, aes(x = size)) +
#   geom_histogram(binwidth = 1, aes(fill = site)) +
#   scale_fill_manual(values = cal_palette("superbloom")
```

```{r par model - additional figures, include=TRUE}

# scatterplot: PAR x month 
ggplot(data = parmod, aes(x = date, y = normalized_par)) + 
  geom_point(aes(color = site)) +
  labs(title = "Normalized PAR over time", x = "Date", y = "Normalized PAR") +
  theme_bw() 

# boxplot: PAR by month <---- KIT - can you make a figure that shows a boxplot of normPAR for each month? <-- need to change YEAR, MONTH, SITE, to character. 3
parmod %>%
group_by(year, treatment) %>%
summarize(mean_par=mean(normalized_par), 
          sd_par=sd(normalized_par), 
)
          
parmod_box <- parmod %>% 
    mutate(col_types = cols(month = col_character()))

ggplot(data = parmod, 
       aes(x = month, y = normalized_par)) +
  labs(title = "Normalized PAR over time", x = "Month", y = "Normalized PAR") +
  geom_boxplot() +
  theme_bw() 

# boxplot: PAR by site x treatment <-- broken and
ggplot(data = parmod, aes(x = treatment, y = normalized_par)) +
  geom_boxplot(aes(color = sitecolors)) #+
  labs(title = "Normalized PAR over #time", x = "MAFA canopy cover (%)", y = "Date") +
  theme_bw() 


```

------------------------------------------------------------------------

## TDR linear mixed-effects model

1.  lmer
2.  testing the residuals for normality

```{r tdrmod - normality, include = TRUE}

lme.tdrmod <- lmer(soil_moisture ~ treatment + mafacover + site + year + month + (1|date) +(1|plot_number),
                   data = tdrmod)

MOD <- lme.tdrmod

# Calculate model's residual and fitted values
F1 <- fitted(MOD)
E1 <- residuals(MOD, "pearson")

# See residuals as a histogram, look for normal distribution
hist(E1)

# Graph residuals against a normal distribution, look for all points to be on 1:1 line
#need to call next two lines together
qqnorm(E1, xlab = "Theoretical Quantiles", ylab = "Pearson Residuals")
qqline(E1)

# Graph residuals vs fitted values to inspect homogeneity of variance, look for a random scattering of plots
# run together 2 lines
plot(x=F1, y=E1, xlab="Fitted Model Values", ylab="Pearson Residuals", main = "Variance")
abline(h = 0) # looking for random scatter

# Check for crazy outliers, look for lines MUCH taller than the rest of data
plot(cooks.distance(MOD))

# Plot a box plot for each factor, look for equal variance amount levels along the zero line
# Box plots need to be assessed for every fixed effect (categorical factor) for your model. 
# Random effects need the qqline just like normality. 
# So, only site and treatment get box plots. 
# MAFA cover is a covariate (continuous variable).
boxplot(E1 ~ treatment, data = tdrmod)
abline(h = 0)

boxplot(E1 ~ site, data = tdrmod)
abline(h = 0)

boxplot(E1 ~ year, data = tdrmod)
abline(h = 0)

boxplot(E1 ~ month, data = tdrmod)
abline(h = 0)

# Plot each random effect in the model, look for dots along 1:1 line
qqnorm(ranef(MOD)$date[,1], main = "Plot Residuals")
qqline(ranef(MOD)$date[,1])

qqnorm(ranef(MOD)$plot_number[,1], main = "Plot Residuals")
qqline(ranef(MOD)$plot_number[,1])
```

3.  statistics

```{r tdrmod - stats, include = TRUE}
# print 
print(lme.tdrmod)
summary(lme.tdrmod)
anova(lme.tdrmod) # A significant p-value indicates that one or more significant differences exist between group means.
# site and treatment are significant. mafacover, year, month are not significant.

# visualize significant factors from anova(lme.tdrmod)
emmip(lme.tdrmod, site ~ treatment)
# emmip(lme.tdrmod, month ~ treatment | site)

# get stats on interactions
emmeans(lme.tdrmod, list(pairwise ~ site*treatment), adjust = "tukey")
#lsmeans(lme.tdrmod, pairwise~site*treatment, adjust="tukey") # emmeans and lsmeans give the same results

tdrmod %>% 
  group_by(year, month) %>% 
  summarise(MEAN_soil_moisture=mean(soil_moisture, na.rm = TRUE),
            SD = sd(soil_moisture, na.rm = TRUE),
            N = length(soil_moisture), 
            SE = ((sd(soil_moisture, na.rm = TRUE))/sqrt(length((soil_moisture))))
            )
```

```{r tdrmod - additional stats, include=TRUE}
# TDR by Site and Treatment
# tdrmod$site  <- as.factor(tdrmod$site) # to make site a factor
tdrmod_site_treat <- aov(soil_moisture ~ site*treatment, data = tdrmod) 
anova(tdrmod_site_treat)
TukeyHSD(tdrmod_site_treat)
plot(TukeyHSD(tdrmod_site_treat))
# 2:none-1:full -6.4912037 -12.944263 -0.03814456 0.0477765

# TDR by Site <-- why does this say site is sig when it wasn't before?
tdrmod_site <- aov(soil_moisture ~ site, data = tdrmod) 
anova(tdrmod_site)
# site        1  344.6  344.57  7.7869 0.006242 **

tdrmod_treat <- aov(soil_moisture ~ treatment, data = tdrmod) 
anova(tdrmod_treat)
# treatment   2  154.9  77.446  1.6663 0.1939
 
# For TDR and nn cover, the significant plots may explain results we see later, but the fact that there are 2-3 plots that are significantly different from each other doesn't tell us the sites or treatments are significantly different from each other. 
```

4.  figures

```{r tdrmod - figures, include = TRUE}

# boxplot: TDR by site by treatment
ggplot(data = tdrmod, aes(x = site, y = soil_moisture)) +
  geom_boxplot(aes(fill = treatment)) +
  scale_fill_manual(values = c('#F6EECF', '#B09175', '#291611')) +
  labs(title = "Soil Moisture by Site and Treatment", x = "Site", y = "Soil Moisture (%)") +
  theme_bw() 

# scatterplot: tdr x mafacover 
ggplot(data = tdrmod, aes(x = mafacover, y = soil_moisture)) + 
  geom_point(aes(color = site)) +
  scale_color_manual(values=c(sitecolors)) +
  labs(title = "Soil Moisture by Site and Treatment", x = "Site", y = "Soil Moisture (%)") +
  geom_smooth(method="lm")+
  theme_bw()


```

------------------------------------------------------------------------

## Non-native cover linear mixed-effects model

1.  lmer
2.  testing the residuals for normality

```{r nnmod - normality, include = TRUE}

#need to convert df to a tibble
#as_tibble(nnmod)
#print(nn)
#names(nnmod)
#print(nnmod)
#str(nnmod)
lme.nnmod <- lmer(nncover ~ treatment + mafacover + site + year + (1|date) + (1|plot_number), # no month column, year = month
                   data = nnmod) 

MOD <- lme.nnmod

# Calculate model's residual and fitted values
F1 <- fitted(MOD)
E1 <- residuals(MOD, "pearson")

# See residuals as a histogram, look for normal distribution
hist(E1)

# Graph residuals against a normal distribution, look for all points to be on 1:1 line
#need to call next two lines together
qqnorm(E1, xlab = "Theoretical Quantiles", ylab = "Pearson Residuals")
qqline(E1)

# Graph residuals vs fitted values to inspect homogeneity of variance, look for a random scattering of plots
# run together 2 lines
plot(x=F1, y=E1, xlab="Fitted Model Values", ylab="Pearson Residuals", main = "Variance")
abline(h = 0) # looking for random scatter

# Check for crazy outliers, look for lines MUCH taller than the rest of data
plot(cooks.distance(MOD))

# Plot a box plot for each factor, look for equal variance amount levels along the zero line
# Box plots need to be assessed for every fixed effect (categorical factor) for your model. 
# Random effects need the qqline just like normality. 
# So, only site and treatment get box plots. 
# MAFA cover is a covariate (continuous variable).
boxplot(E1 ~ treatment, data = nnmod)
abline(h = 0)

boxplot(E1 ~ site, data = nnmod)
abline(h = 0)

boxplot(E1 ~ year, data = nnmod)
abline(h = 0)

# Plot each random effect in the model, look for dots along 1:1 line
qqnorm(ranef(MOD)$date[,1], main = "Plot Residuals")
qqline(ranef(MOD)$date[,1])

qqnorm(ranef(MOD)$plot_number[,1], main = "Plot Residuals")
qqline(ranef(MOD)$plot_number[,1])
```

3.  statistics

```{r nnmod - stats, include=TRUE}
# print 
print(lme.nnmod)
summary(lme.nnmod)
anova(lme.nnmod) # A significant p-value indicates that one or more significant differences exist between group means.
# non-native cover is not correlated with mafa cover, treatment, site, or year.
# year may be ecologically interesting (p = 0.065)

# visualize significant factors from anova(lme.tdrmod)
emmip(lme.nnmod, site*year)
# emmip(lme.tdrmod, month ~ treatment | site)

# convert from character to number
# nnmod$year <- as.numeric(nnmod$year)
# nnmod$site <- as.numeric(nnmod$site)

nnmod$year <- as.character(nnmod$year)
nnmod$site <- as.character(nnmod$site)
nnmod$treatment <- as.character(nnmod$treatment)

# get stats on interactions
emmeans(lme.tdrmod, pairwise~year*treatment, adjust="tukey")
# lme.tdrmod_letters <- multcompLetters(lme.tdrmod_emmeans)
# print(letters)

#lsmeans(lme.tdrmod, pairwise~site*treatment, adjust="tukey") # emmeans and lsmeans give the same results

nnmod %>% 
  group_by(year, site, treatment) %>% 
  summarise(mean_nncover=mean(nncover, na.rm = TRUE),
            sd_nncover = sd(nncover, na.rm = TRUE), 
            N = length(nncover),
            SE_nncover=((sd(nncover, na.rm = TRUE))/sqrt(length((nncover))))
            )
```

```{r nnmod - additional stats, include=TRUE}
# non-native cover by treatment
nnmod_treat <- aov(nncover ~ treatment, data = nnmod) 
anova(nnmod_treat)
TukeyHSD(nnmod_treat)
plot(TukeyHSD(nnmod_treat))

# non-native cover by treatment and site
nnmod_treat_site <- aov(nncover ~ treatment*site, data = nnmod) 
anova(nnmod_treat_site)
TukeyHSD(nnmod_treat_site)
plot(TukeyHSD(nnmod_treat_site))

# For TDR and nn cover, the significant plots may explain results we see later, but the fact that there are 2-3 plots that are significantly different from each other doesn't tell us the sites or treatments are significantly different from each other. 
```

4.  figures

```{r nnmod - figures, include=TRUE}

nnmod$site = as.factor(nnmod$site)

# boxplot: nncover x year
ggplot(data = nnmod, aes(x = year, y = nncover)) + 
  geom_boxplot(aes(fill = year)) +
 # scale_fill_manual(values = c('#F19B34', '#9F7E75', '#92A587')) +
 # scale_fill_manual(values = c('#F6EECF', '#B09175', '#291611')) +
  labs(title = "Non-native cover by Site and Treatment", x = "Site", y = "Non-native cover (%)") +
  geom_smooth(method="lm") +
  theme_bw()

# boxplot: nncover x site x treatment (no correlation)
nnmod$site = as.factor(nnmod$site)
ggplot(data = nnmod, aes(x = site, y = nncover)) + 
  geom_boxplot(aes(fill = treatment)) +
 # scale_fill_manual(values = c('#F19B34', '#9F7E75', '#92A587')) +
  scale_fill_manual(values = c('#F6EECF', '#B09175', '#291611')) +
  labs(title = "Non-native cover by Site and Treatment", x = "Site", y = "Non-native cover (%)") +
  geom_smooth(method="lm") +
  theme_bw()

# boxplot: mafacover x treatment x site (no correlation)
ggplot(data = nnmod, aes(x = treatment, y = nncover)) + 
  geom_boxplot(aes(fill = site)) +
  geom_smooth(method="lm") +
  labs(title = "Non-native cover by Treatment and Site", x = "Treatment", y = "Non-native cover (%)") +
  scale_fill_manual(values = c(sitecolors)) +
  # scale_fill_manual(values = c('#D3E3CA', '#92A587')) +
  theme_bw()

# scatterplot: nncover x mafacover (no correlation)
ggplot(data = nnmod, aes(x = mafacover, y = nncover)) + 
  geom_point() +
  geom_smooth(method="lm")+
  theme_bw()
```

------------------------------------------------------------------------

# Question 1: Take aways

### PAR

-   PAR is significantly correlated with MAFA cover.
-   PAR is not correlated with treatment, site, or month.
-   More canopy cover does mean more shade, and less canopy cover means more sun.
-   No influence of month is expected since we normalized PAR values.

### TDR

-   soil moisture is significantly correlated with site and treatment
-   There are no effects of MAFA canopy cover, year, or month on soil moisture.
-   Soil moisture is greater at Site 1 than at Site 2 by treatment (e.g., full removal at Site 1 has more soil moisture than full removal at Site 2)

### Non-native cover

-   Non-native cover is not correlated with Treatment, Site, MAFA cover (%), or year.
-   This could be because we measured non-native cover once a year at peak biomass/peak growth in May-June

# Question 2: How does seedling survival change by PAR, TDR, and mafacover?

Is canopy treatment or canopy cover a stronger predictor of the environmental conditions below the shrub canopy?

------------------------------------------------------------------------

# Glossary

## *df exploration*

- *dim(df)* gives you number of rows and columns in the df 
- *str(df)* gives you the structure of your dataframe 
- *names(df)* will give you the column names in the df 
- *install.packages()* to install packages 
- *installed.packages()* to see what packages are installed 
- *class(df)* to tell if df or tibble 
  + df \<- as_tibble(df) to turn into a tibble

## *dplyr*

- *filter()* for sub-setting row/observations 
- *select()* for sub-setting columns/variables 
- *mutate()* for transforming variables \* df %\>% mutatue(newcolumn_name = variable selection) \* ==, \<, \>, can make multiple new columns within one mutate command 
- *group_by(catvariable)* for numerical summaries of categories (e.g., site, treatment, species) 
- *summarise(meansurvival = mean(survival), n = n())* for numerical summaries of observations (e.g., height, survival, percent cover) + n = n() will count total observations for your variable meanWage + creates a new tibble with a summary for each level 
- *fivenum()* for all 5 summaries

## *statistics*

-   lmer: Fit Linear Mixed-Effects Models
    -   Fit a linear mixed-effects model (LMM) to data, via REML or maximum likelihood.
-   letters
    -   <https://statdoe.com/cld-customisation/>
-   emmeans-package
    -   emmeans() = Estimated marginal means
    -   emtrends()
-   ANOVA
    -   result \<- aov(response_variable \~ explanitory_variable, data = df) TukeyHSD(parmod_treatment) plot(TukeyHSD(parmod_treatment))
-   t-test: compare the means of two groups
    -   with data from two dfs --\> t.test(par1\$response_variable, par2(dollarsign)response_variable)
    -   with data from one df --\> t.test(normalized_par \~ year, data = parmod)

## *Rmd*

# Tips

*If things start to break*, run the code from the beginning. The environment may need to be cleared and reset. *DO NOT fix data in EXCEL.* Use R. Once you "finalize" your raw data, don't touch it or re-save it. Doing that can change the column formatting, which can break your importing code.

**end of code**
